<%- include('../../partials/header') %>

<h1 class="text-2xl font-bold text-gray-900 dark:text-white mb-2">Cooked: <%= result.recipe.title %></h1>
<p class="text-sm text-gray-500 dark:text-gray-400 mb-6">
  <%= result.requestedServings %> serving<%= result.requestedServings !== 1 ? 's' : '' %>
</p>

<% if (result.deductions.length > 0) { %>
  <div class="bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-xl p-5 mb-6">
    <h2 class="font-semibold text-green-800 dark:text-green-300 mb-3">Pantry Updated</h2>
    <div class="space-y-2">
      <% result.deductions.forEach(function(d) { %>
        <div class="flex items-center justify-between text-sm">
          <span class="font-medium text-green-800 dark:text-green-300"><%= d.pantryItemName %></span>
          <div class="text-right">
            <span class="text-red-600 dark:text-red-400">-<%= d.amountDeducted %> <%= d.unit %></span>
            <span class="text-gray-500 dark:text-gray-400 ml-2">now <%= d.newQuantity %> <%= d.unit %></span>
          </div>
        </div>
      <% }); %>
    </div>
  </div>
<% } %>

<% if (result.skipped.length > 0) { %>
  <div class="bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-xl p-5 mb-6">
    <h2 class="font-semibold text-yellow-800 dark:text-yellow-300 mb-3">Skipped Items</h2>
    <div class="space-y-2">
      <% result.skipped.forEach(function(s) { %>
        <div class="text-sm">
          <span class="font-medium text-yellow-800 dark:text-yellow-300"><%= s.ingredientName %></span>
          <span class="text-yellow-600 dark:text-yellow-400"> &mdash; <%= s.reason %></span>
        </div>
      <% }); %>
    </div>
  </div>
<% } %>

<% if (result.replenishItems.length > 0) { %>
  <div class="bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-5 mb-6">
    <h2 class="font-semibold text-blue-800 dark:text-blue-300 mb-3">Added to Auto-Replenish List</h2>
    <div class="space-y-1">
      <% result.replenishItems.forEach(function(r) { %>
        <div class="text-sm text-blue-700 dark:text-blue-400">
          <span class="font-medium"><%= r.name %></span>
          &mdash; <%= r.currentQuantity %>/<%= r.originalQuantity %> <%= r.unit %> remaining
        </div>
      <% }); %>
    </div>
    <% if (result.autoReplenishListId) { %>
      <a href="/grocery/<%= result.autoReplenishListId %>" class="inline-block mt-3 text-sm font-medium text-blue-700 dark:text-blue-300 hover:underline">
        View Auto-Replenish List &rarr;
      </a>
    <% } %>
  </div>
<% } %>

<div class="flex flex-col sm:flex-row gap-3">
  <a href="/recipes/saved" class="btn-primary text-center">Back to Saved Recipes</a>
  <a href="/pantry" class="btn-secondary text-center">View Pantry</a>
</div>

<%- include('../../partials/footer') %>
